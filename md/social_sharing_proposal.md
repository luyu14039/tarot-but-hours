# 社交分享功能设计方案：无形之墨 (The Invisible Ink)

## 1. 概述
本方案旨在增强《司辰塔罗》的社交传播属性，同时严格保护用户的隐私。我们将通过生成精美的、带有神秘学风格的图片（海报），鼓励用户在社交媒体（微信朋友圈、小红书、Twitter等）分享。

核心理念是**“分享氛围与原型，而非隐私细节”**。

---

## 2. 场景设计

### 场景 A：首页 - 漫宿的邀请函 (The Invitation)
**定位**：向他人介绍这个网站，展示网站的独特美学。
**触发时机**：用户点击首页的“分享”按钮（可放置在“Star on GitHub”旁）。

**图片内容构成**：
1.  **核心视觉**：随机展示一位“司辰”的卡牌或图标（如“赤杯”、“双角斧”），配以其尊号。
2.  **引言 (Quote)**：一句来自《密教模拟器》或《司辰之书》的经典谶语（如“世界不会变老，但它会改变外皮”）。
3.  **品牌标识**：网站标题 "Tarot of the Hours" 及副标题。
4.  **入口**：带有网站链接的二维码。
5.  **装饰**：华丽的边框（Frame），深色背景，金色文字。

**用户价值**：作为一种“电子护身符”或“每日签到”分享，展示品味。

---

### 场景 B：结果页 - 飞升的见证 (The Witness)
**定位**：展示占卜的仪式感和结果的神秘性，但不暴露具体问题。
**触发时机**：解读生成完毕后，在结果页底部或侧边栏出现“留影/分享”按钮。

**图片内容构成（分层设计）**：
1.  **牌阵可视化 (The Spread)**：
    *   这是视觉重心。按实际抽牌位置排列展示抽到的卡牌（可以是精简版卡面，强调插图和司辰名字）。
    *   *隐私考量*：只展示牌面，不展示具体的解牌文本。牌面本身具有多义性，适合公开。
2.  **仪式时间**：显示占卜发生的日期和时间（如“2026年1月2日 虚界之夜”）。
3.  **核心启示 (The Key)**：
    *   从 AI 生成的“飞升 (Ascension)”部分提取一句话作为总结（需 AI 配合输出一个短句，或者由用户手动选择是否展示）。
    *   *隐私开关*：提供一个勾选框 **[ ] 展示我的问题**（默认关闭）。只有勾选后，图片上才会印上用户的问题。
4.  **入口**：二维码。

**隐私保护策略**：
*   **默认模式**：仅包含牌阵图像 + 网站Logo + 二维码。这看起来像是一件艺术品。
*   **可选模式**：用户可手动开启“显示问题”或“显示解读摘要”。

---

## 3. 视觉风格 (Visual Style)

为了符合原著世界观，分享图将采用以下设计语言：

*   **色调**：
    *   背景：虚空黑 (`#111111`) 或 深羊皮纸色。
    *   文字：苍白金 (`#D4AF37`) 或 幽灵白 (`#F8F8FF`)。
*   **字体**：
    *   标题：`UnifrakturMaguntia` (哥特体，极具仪式感)。
    *   正文：`Cormorant Garamond` (优雅衬线体)。
*   **装饰元素**：
    *   使用现有的 `Frame` 组件作为图片边框。
    *   角落加入粒子效果或星辰点缀。

---

## 4. 技术实现方案

### 4.1 核心库选择
由于项目是静态导出（`output: 'export'`），我们采用**客户端生成**方案，无需后端服务。

*   **`html2canvas`** 或 **`dom-to-image-more`**：
    *   用于将 DOM 节点转换为图片。
    *   *优点*：可以直接复用现有的 React 组件样式，所见即所得。
    *   *缺点*：对部分 CSS 属性（如复杂阴影、混合模式）支持有限，需针对性调整。
*   **`qrcode.react`**：
    *   用于在前端动态生成二维码组件。

### 4.2 实现流程
1.  **隐藏的渲染容器**：
    *   在页面中创建一个对用户不可见（`position: absolute; left: -9999px`）的 `div` 容器。
    *   在这个容器中渲染专门为分享设计的 React 组件（`ShareCard`）。这个组件的尺寸固定（例如 1080x1920 适合手机竖屏，或 1080x1080 方图）。
2.  **预览模态框 (Modal)**：
    *   用户点击“分享”时，弹出一个 Modal。
    *   Modal 中显示 `ShareCard` 的**预览**（缩放版）。
    *   提供“隐私开关”控件（如“显示问题”）。
3.  **生成与下载**：
    *   用户点击“保存图片”。
    *   调用 `html2canvas` 捕捉隐藏容器或预览容器。
    *   将 Canvas 转换为 DataURL (PNG/JPG)。
    *   触发浏览器下载行为。

---

## 5. 开发计划 (Roadmap)

1.  **安装依赖**：`npm install html2canvas qrcode.react`
2.  **组件开发**：
    *   `components/Share/ShareModal.tsx`: 包含预览和控制逻辑。
    *   `components/Share/HomeShareCard.tsx`: 首页邀请函样式。
    *   `components/Share/ReadingShareCard.tsx`: 结果页样式（含牌阵）。
3.  **集成**：
    *   在 `app/page.tsx` 引入首页分享。
    *   在 `app/reading/page.tsx` 引入结果页分享。

## 6. 待确认事项
*   是否需要为分享图设计专门的背景纹理？（建议使用简单的深色噪点背景即可）
*   二维码指向的链接是否需要带 UTM 参数以追踪来源？（建议加上 `?source=share_image`）

